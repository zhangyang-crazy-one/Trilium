---
name: spec-interview
description: |
  深度访谈技能 - 完善技术规格和项目文档。

  触发场景：
  - 存在 plan.md 需要完善
  - 用户指定文档需要细化
  - 草稿规格需要全面细化

  触发词：帮我完善这个plan、问我关于项目的问题、完善规格、细化需求、spec review
---

# 规格访谈技能

## 概述

通过深入、探究式的访谈，将草稿规格说明转化为完整的技术文档。

## 使用场景

### 场景 1: 完善 plan.md

```
用户: 帮我完善这个plan
代理: 阅读 plan.md，使用 AskUserQuestion 提问，完善后写入 plan.md
```

### 场景 2: 细化指定文档

```
用户: 问我关于项目的问题来完善这个 spec
代理: 读取指定文档，提问，完善后写回
```

## 访谈维度

### 技术实现

- 技术选型的理由和替代方案
- API 设计和数据流
- 性能考虑和优化策略
- 错误处理和边界情况

### UI/UX 设计

- 用户交互流程
- 视觉反馈和状态处理
- 无障碍和国际化
- 响应式适配

### 架构决策

- 模块划分和职责
- 状态管理策略
- 数据持久化方案
- 第三方依赖管理

### 风险考量

- 安全风险和缓解措施
- 兼容性考虑
- 回滚和降级策略
- 监控和可观测性

### 权衡取舍

- 开发速度 vs 代码质量
- 功能完整 vs 快速迭代
- 用户体验 vs 技术复杂度
- 短期目标 vs 长期维护

## 访谈流程

### 阶段 1: 文档分析

1. 读取 plan.md 或用户指定文档
2. 识别不明确或有歧义的部分
3. 确定需要深入探讨的领域

### 阶段 2: 系统性提问

使用 `AskUserQuestion` 工具进行访谈：

```typescript
const questions = [
  {
    question: "关于技术实现...",
    header: "技术",
    options: [
      { label: "方案A", description: "..." },
      { label: "方案B", description: "..." }
    ],
    multiSelect: false
  },
  {
    question: "关于 UI/UX...",
    header: "UI/UX",
    options: [
      { label: "方案A", description: "..." },
      { label: "方案B", description: "..." }
    ],
    multiSelect: false
  }
];
```

### 阶段 3: 规格完善

根据访谈结果，更新文档结构：

```markdown
# 项目规格说明书

## 1. 概述
[原有内容 + 补充说明]

## 2. 技术架构
### 2.1 技术选型
- 已确定: [技术栈]
- 待确认: [问题列表]

### 2.2 架构决策
[详细决策记录]

## 3. 功能需求
### 3.1 核心功能
[功能列表]

### 3.2 边缘情况
[处理策略]

## 4. UI/UX 设计
[交互流程和视觉规范]

## 5. 风险评估
[风险列表和缓解措施]

## 6. 实施计划
[优先级和里程碑]

## 7. 问答记录
### 问题 1: [问题内容]
**回答**: [用户回答]

### 问题 2: [问题内容]
**回答**: [用户回答]
```

### 阶段 4: 访谈结束

当满足以下条件时，结束访谈：
- 所有关键问题已回答
- 规格说明完整且一致
- 没有新的问题需要澄清

## 与其他技能协同

| 技能 | 协同方式 |
|------|----------|
| **react-frontend** | 前端实现细节访谈 |
| **electron-main** | 主进程和 IPC 设计访谈 |
| **ai-integration** | AI 功能需求访谈 |
| **bug-debug** | 风险和边缘情况访谈 |
| **rag-vectordb** | 数据存储和检索访谈 |

## 输出格式

访谈完成后，将完善后的规格写入源文件：

```markdown
---
更新日期: 2024-XX-XX
访谈状态: 已完成
---

# [文档标题]

## 元信息
- 版本: X.Y.Z
- 最后更新: YYYY-MM-DD
- 访谈轮次: N 轮

## 核心内容
[完整的技术规格]

## 问答记录
[所有问题和回答的详细记录]

## 待办事项
- [ ] 项目 1
- [ ] 项目 2
```

## 最佳实践

1. **保持深度**: 提问要有深度，避免浅显问题
2. **循序渐进**: 从宏观到微观，层层深入
3. **记录决策**: 记录每个决策的理由
4. **确认理解**: 在继续前确认理解正确
5. **结构清晰**: 保持文档结构一致

## 禁止事项

- ❌ 跳过未完成的访谈
- ❌ 假设用户意图而不确认
- ❌ 提出显而易见的问题
- ❌ 遗漏关键边缘情况

## 检查清单

- [ ] 是否读取了源文档
- [ ] 是否进行了深度访谈
- [ ] 是否覆盖所有维度
- [ ] 是否将结果写回文档
- [ ] 是否确认访谈完成

## 参考资源

- `docs/TODO.md` - 待办任务
- `docs/PROJECT_STATUS.md` - 项目状态
- `.claude/plans/` - 计划文件目录
